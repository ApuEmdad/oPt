Option Explicit
Sub UnlockColumnExceptHeader(ws As Worksheet, colNum As Long)
    ' Unlock entire column
    ws.Columns(colNum).Locked = False
    ' Lock the header cell in row 1
    ws.Cells(1, colNum).Locked = True
End Sub


Private Sub Workbook_Open()
    Dim ws As Worksheet
    Dim colStatus As Long
    
    ' Set target sheet
    Set ws = ThisWorkbook.Sheets("Update oPt Cases")

    ' Protect the sheet but allow VBA/Power Automate to write
    ws.Protect Password:="admin", UserInterfaceOnly:=True

    ' Lock everything first
    ws.Cells.Locked = True

    ' Get column number
    colStatus = GetColByHeader(ws, "Status")
    
    Call UnlockColumnExceptHeader(ws, colStatus)

   
End Sub